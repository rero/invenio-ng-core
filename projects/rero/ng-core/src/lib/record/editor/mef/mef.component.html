<!--
 Invenio angular core
 Copyright (C) 2019 RERO

 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, version 3 of the License.

 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<h4 *ngIf="controlValue">
  <span class="badge badge-light">{{ asyncSelected.name|translate }}</span>
</h4>

<ng-template #customItemTemplate let-match="match" let-query="query" let-model="item" let-index="index">
  <span [innerHtml]="model.name"></span>
</ng-template>
<form *ngIf="!controlValue" #form class="input-group" action="" [ngClass]="{'input-group-lg': true}" role="search"
  autocomplete="off">

  <div class="input-group mb-2">
    <input name="q" type="search" [(ngModel)]="asyncSelected.query" [typeaheadAsync]="true" [typeahead]="dataSource"
      (typeaheadLoading)="changeTypeaheadLoading($event)" [typeaheadOptionsLimit]="10" typeaheadOptionField="ref"
      class="form-control" [typeaheadWaitMs]="300" [typeaheadMinLength]="0" [typeaheadItemTemplate]="customItemTemplate"
      (typeaheadOnSelect)="typeaheadOnSelect($event)" typeaheadGroupField="category"
      (input)="valueChanged($event.target.value)">
      <div class="input-group-append">
        <span class="input-group-text"><i class="fa fa-search"></i></span>
      </div>
    </div>
</form>
